crapi=new CrAPI;CrAPI.prototype.manifest=function(){return chrome.runtime.getManifest()};CrAPI.prototype.debug=crapi.manifest().debug;
function CrAPI(){console.groupCollapsed("CrAPI :: Init");console.time("CrAPI init");this.DEFAULT_CALLBACK=function(a){return"undefined"!=typeof a?a:!1};console.log("DEFAULT_CALLBACK: %O",this.DEFAULT_CALLBACK);this.badgeColors={gray:"#9a9a9a",red:"#d00"};console.log("badgeColors: %O",this.badgeColors);this.badgeOptions={title:!1,color:!1,text:!1};console.log("badgeOptions: %O",this.badgeOptions);console.timeEnd("CrAPI init");console.groupEnd()}
CrAPI.prototype.clone=function(a){"undefined"==typeof a&&(a=this.DEFAULT_CALLBACK);console.groupCollapsed("CrAPI :: Clone storage");console.time("CrAPI clone");crapi.debug&&console.trace("Stack trace");chrome.storage.local.get(function(b){console.log("Storage: %O",b);console.timeEnd("CrAPI clone");console.groupEnd();a(b)})};
CrAPI.prototype.update=function(a,b,c){"undefined"==typeof c&&(c=this.DEFAULT_CALLBACK);console.groupCollapsed("CrAPI :: Update storage");console.time("CrAPI update");crapi.debug&&console.trace("Stack trace");var d={};d[a]=b;chrome.storage.local.set(d,function(){console.log("New storage: %O",d);console.timeEnd("CrAPI update");console.groupEnd();c(b)})};
CrAPI.prototype.updateAll=function(a,b){"undefined"==typeof b&&(b=this.DEFAULT_CALLBACK);console.groupCollapsed("CrAPI :: Update all storage");console.time("CrAPI update all");crapi.debug&&console.trace("Stack trace");chrome.storage.local.set(a,function(){console.log("New storage: %O",a);console.timeEnd("CrAPI update all");console.groupEnd();b()})};
CrAPI.prototype.badge=function(a){console.groupCollapsed("CrAPI :: Update badge");console.time("CrAPI badge");crapi.debug&&console.trace("Stack trace");a=$.extend({},this.badgeOptions,a);var b="undefined"!=typeof this.badgeColors[a.color]?this.badgeColors[a.color]:a.color;console.log("Options: %O",a);console.log("Color:",b);!1!==a.title&&chrome.browserAction.setTitle({title:a.title});!1!==b&&chrome.browserAction.setBadgeBackgroundColor({color:b});!1!==a.text&&chrome.browserAction.setBadgeText({text:a.text});
console.timeEnd("CrAPI badge");console.groupEnd()};modapi=new ModAPI;modapi.manifest=crapi.manifest();function ModAPI(){console.groupCollapsed("ModAPI :: Init");console.time("ModAPI init");this.DEFAULT_CALLBACK=function(){};console.log("DEFAULT_CALLBACK: %O",this.DEFAULT_CALLBACK);console.timeEnd("ModAPI init");console.groupEnd()}
ModAPI.prototype.login=function(b){function c(a){$.getJSON("http://api.soundation.com/me").fail(function(a,b){console.timeEnd("ModAPI login");console.groupEnd();console.error("Unable to connect to Soundation API")}).success(function(b){a(b.data)})}"undefined"==typeof b&&(b=this.DEFAULT_CALLBACK);console.groupCollapsed("ModAPI :: Login");console.time("ModAPI login");crapi.debug&&console.trace("Stack trace");c(function(a){console.log("Attempt 1: %O",a);a?(console.timeEnd("ModAPI login"),console.groupEnd(),
b(a)):(console.warn("Attempt 1 failed! Pinging Soundation..."),$.get("http://soundation.com").always(function(){c(function(a){console.log("Attempt 2: %O",a);console.timeEnd("ModAPI login");console.groupEnd();b(a)})}))})};
